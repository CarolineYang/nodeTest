/**
 * tinymce plugin
 * Created by jerry on 16/8/5.
 */
tinymce.PluginManager.add('fold', function (editor) {

    function selectLocalImages(e) {
        var dom = editor.dom;
        editor.windowManager.open({
            title: "折叠",
            size: "normal",
            body: {type: "panel", items: [{name: "id", type: "input", label: "ID", placeholder: "example"}]},
            buttons: [{type: "cancel", name: "cancel", text: "Cancel"}, {
                type: "submit",
                name: "save",
                text: "Save",
                primary: !0
            }],
            onSubmit: function (t) {
                var tar=editor.selection.getNode();
                tar.id=t.getData().id;
                t.close();
                t.focus();
                var hh='<span id="'+t.getData().id+'">'+editor.selection.getContent()+'</span>';
                // console.log(editor.selection,editor.selection.getStart(),t)
                // console.log(editor.selection.getContent())
                // editor.selection.setContent(editor.selection.getContent())
                editor.bookmarkss={
                    id:t.getData().id,
                    content:editor.selection.getContent(),
                    flag:true,
                    begin:0
                };
                editor.execCallback("foldcallback", editor)
            }
        })
    }

    editor.addCommand("foldPartEditor", selectLocalImages);

    editor.ui.registry.addButton('fold', {
        icon: 'chevron-up',
        tooltip: '折叠显示',
        onAction: (_) => editor.execCommand('foldPartEditor')
    });

    editor.ui.registry.addMenuItem('fold', {
        icon: 'chevron-up',
        text: '折叠显示',
        context: 'tools',
        onAction: (_) => editor.execCommand('foldPartEditor')
    });
});